# Managed by Chef for node <%= node['fqdn'] -%>.

############
# Datasets #
############

<% if @datasets %>
<% @datasets.each do |dataset| -%>
<% set = dataset[1] -%>
[<%= set.name %>]
  use_template = <%= set.use_template %>
  <% set.hourly if set.hourly -%>
  <% set.daily if set.daily -%>
  <% set.monthly if set.monthly -%>
  <% set.yearly if set.yearly -%>
  <% set.autosnap if set.autosnap -%>
  <% set.autoprune if set.autoprune -%>
  <% set.min_percent_free if set.min_percent_free -%>
  <% set.hourly_min if set.hourly_min -%>
  <% set.daily_hour if set.daily_hour -%>
  <% set.daily_min if set.daily_min -%>
  <% set.monthly_mday if set.monthly_mday -%>
  <% set.monthly_mhour if set.monthly_mhour -%>
  <% set.monthly_min if set.monthly_min -%>
  <% set.yearly_yday if set.yearly_yday -%>
  <% set.yearly_hour if set.yearly_hour -%>
  <% set.yearly_min if set.yearly_min -%>
<% end -%>
<% end -%>

#############
# Templates #
#############

<% if @templates %>
<% @templates.each do |template| -%>
<% Chef::Log.info "TESTTESTSETSETESTSE #{ template[1] }" -%>
<% set2 = template[0] -%>
[template-<%= set2.name %>]
  <% set2.hourly if set2.hourly -%>
  <% set2.daily if set2.daily -%>
  <% set2.monthly if set2.monthly -%>
  <% set2.yearly if set2.yearly -%>
  <% set2.autosnap if set2.autosnap -%>
  <% set2.autoprune if set2.autoprune -%>
  <% set2.min_percent_free if set2.min_percent_free -%>
  <% set2.hourly_min if set2.hourly_min -%>
  <% set2.daily_hour if set2.daily_hour -%>
  <% set2.daily_min if set2.daily_min -%>
  <% set2.monthly_mday if set2.monthly_mday -%>
  <% set2.monthly_mhour if set2.monthly_mhour -%>
  <% set2.monthly_min if set2.monthly_min -%>
  <% set2.yearly_yday if set2.yearly_yday -%>
  <% set2.yearly_hour if set2.yearly_hour -%>
  <% set2.yearly_min if set2.yearly_min -%>
<% end -%>
<% end -%>